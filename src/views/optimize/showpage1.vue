<template>
  <div class="container" v-loading="loading">
    <div class="page" id="page1" v-show="state!=3">
      <el-button type="primary" v-show="state==0" @click="start">开始仿真</el-button>
      <span v-show="state==1">正在仿真中，请等待...</span>
      <el-button type="success" v-show="state==2" @click="showdetail">仿真回放</el-button>
    </div>
    <div class="page" id="page2" v-show="state==3">
      <el-collapse v-model="activeName" accordion @change="showecharts">
        <el-collapse-item title="性能展示" name="1">
          <div class="imgBox">
            <div class="imgStarmap" id="imgStarmap1">
              <div id="echarts_line" style="width: 100%; height: 100%"></div>
            </div>
          </div>
        </el-collapse-item>
      </el-collapse>
      <div class="footer">
        <el-button type="primary" @click="alive=false" style="margin-bottom: 20px" v-show="alive">结束仿真</el-button>
        <el-button type="primary" @click="state=0" style="margin-bottom: 20px" v-show="!alive">重新仿真</el-button>
        <el-button type="primary" @click="$router.push('settings1')" style="margin-bottom: 20px" v-show="!alive">编辑参数</el-button>
      </div>
    </div>
  </div>
</template>

<script>
  export default {
    name: "vueLC",
    data () {
      return {
        loading: false,
        state: 0,
        activeName: '1',
        alive: true,
        dataLine: [],
      }
    },
    mounted() {
      this.loading = false;
    },
    methods:{
      start() {
        this.state = 1;
        setTimeout(() => {
          this.state = 2;
        }, 200);
      },
      showdetail() {
        this.dataLog = {
          SNR: [18.0,18.2,18.4,18.6,18.8,19.0,19.2,19.4,19.6,19.8,20.0,20.2,20.4,20.6,20.8,21.0,21.2,21.4,21.6,21.8,22.0,22.2,22.4,22.6,22.8,23.0,23.2,23.4,23.6,23.8,24.0,24.2,24.4,24.6,24.8,25.0,25.2,25.4,25.6,25.8,26.0,26.2,26.4,26.6,26.8,27.0,27.2,27.4,27.6,27.8,28.0],
          BLER: [1.0000,1.0000,1.0000,1.0000,0.9999,1.0000,0.9996,0.9981,0.9957,0.9865,0.9704,0.9454,0.9067,0.8569,0.7886,0.7131,0.6364,0.5602,0.4743,0.3963,0.3416,0.2834,0.2334,0.1890,0.1505,0.1223,0.1057,0.0821,0.0675,0.0488,0.0425,0.0319,0.0277,0.0206,0.0162,0.0159,0.0116,0.0088,0.0067,0.0056,0.0040,0.0034,0.0029,0.0024,0.0018,0.0017,0.0009,0.0008,0.0006,0.0003,0.0001]
        }
        this.dataLine = {
          time: [1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,
          18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,
          34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,
          51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,
          68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,
          85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,
          100,101,102,103,104,105,106,107,108,109],
          RTT_30kHz: [1.30933922,1.33147865,1.33185117,1.37136812,1.37553409,1.41962359,1.54137238,1.65906522,1.67968173,1.65253238,1.6619325,1.6499253,1.68443123,1.65538603,1.62297993,1.64928529,1.67140522,1.63547072,1.69959245,1.71331803,1.70817838,1.65224656,1.64275668,1.6497672,1.68934436,1.63587966,1.64792158,1.65511293,1.68186933,1.67740992,1.67268254,1.64903047,1.6602872,1.6997942,1.63937246,1.70906724,1.66731992,1.66477614,1.62178225,1.75227032,1.66062031,1.66237846,1.74983445,1.78872097,1.66380342,1.66906517,1.68845173,1.6225277,1.66656141,1.65893592,1.64897795,1.65543294,1.62926863,1.65681066,1.67619153,1.71205102,1.65587479,1.63534767,1.72185781,1.65128228,1.66537266,1.66074637,1.7304565,1.63543436,1.66221518,1.66278952,1.64434639,1.66664648,1.63228036,1.68720073,1.62807945,1.52014421,1.67390664,1.66695167,1.65481645,1.66468267,1.59303631,1.62621905,1.74405631,1.63076062,1.65797946,1.69475,1.66704943,1.64538773,1.69164266,1.65597785,1.66716233,1.65714614,1.71504949,1.66280435,1.63735801,1.6586212,1.63511691,1.65842498,1.66127251,1.66008937,1.64650006,1.63163648,1.69496273,1.67012717,1.6675753,1.71151525,1.65487518,1.68138447,1.65656725,1.66632737,1.66144854,1.72381295,1.6428198],
          RTT_120kHz: [0.53112898,0.66601406,0.67198746,0.66666755,0.66289614,0.66261754,0.6701139,0.67138285,0.66029622,0.66545253,0.66502008,0.65524557,0.66100269,0.65466409,0.65731474,0.66152044,0.65234198,0.66004163,0.65236634,0.66297353,0.65996643,0.65755411,0.65359221,0.6563893,0.65313927,0.65362884,0.65969207,0.65079332,0.655526,0.67000909,0.64008093,0.65437426,0.66364898,0.65442682,0.6546776,0.66155126,0.66041641,0.65167905,0.66010764,0.65961437,0.65146544,0.66620968,0.65880704,0.65988562,0.65419906,0.65481283,0.65264176,0.65949041,0.65416511,0.6545524,0.65947785,0.65792269,0.67154127,0.66163149,0.64963108,0.65535994,0.65732179,0.65604242,0.65561014,0.66565428,0.65974724,0.65762246,0.65174128,0.64768023,0.65712078,0.67126704,0.66934519,0.65614351,0.65507887,0.65003271,0.65045435,0.66034706,0.65778558,0.66735763,0.66223753,0.65761249,0.66092147,0.6507353,0.65428406,0.63802083,0.64335597,0.65171151,0.66564531,0.65956165,0.66047516,0.63680356,0.6256635,0.71601222,0.63632771,0.64720226,0.64836745,0.64281201,0.66037472,0.64195277,0.64164381,0.64150483,0.65130883,0.74653898,0.65186461,0.64521222,0.65340068,0.65219801,0.64423347,0.65380366,0.64989606,0.63387267,0.62639042,0.64325739,0.63312032]
        }
        this.state = 3;
        this.showecharts();
      },
      resizeChart() {
        this.showecharts()
      },
      showecharts() {
        let option_line = {
          xAxis: {
            name: '时间',
            type: 'category',
            data: this.dataLine.time
          },
          yAxis: {
            name: 'RTT',
            type: 'value'
          },
          grid: {
            left: '12%',
            top: '10%',
            right: '10%',
            bottom: '5%'
          },
          tooltip: {
            trigger: 'axis'
          },
          legend: {
            data: ['RTT_30kHz','RTT_120kHz']
          },
          series: [
            {data:this.dataLine.RTT_30kHz,type:'line',name:'RTT_30kHz'},
            {data:this.dataLine.RTT_120kHz,type:'line',name:'RTT_120kHz'},
          ]
        };
        this.$nextTick(() => {
          if(document.getElementById('echarts_line')!=null) {
            document.getElementById('echarts_line').removeAttribute("_echarts_instance_");
            this.$echarts.init(document.getElementById('echarts_line')).setOption(option_line);
          }
        })
      }
    }
  }
</script>

<style>
</style>

<style scoped>
  .container {
    position: relative;
    width: 100%;
    height: 100%;
  }
  .page {
    position: relative;
    width: 100%;
    height: 100%;
  }
  #page1 {
    display: flex;
    justify-content: center;
    align-items: center;
  }
  #page2 {
    position: relative;
  }
  #page2 .footer {
    position: absolute;
    bottom: 0;
    left: 0;
  }
  .imgBox {
    width: 100%;
    height: 100%;
    display: flex;
    flex-direction: row;
  }
  .imgStarmap {
    position: relative;
    width: 100%;
    height: 70vh;
    margin-left: 10px;
  }
</style>
